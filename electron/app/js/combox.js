ComboBox=function(e){this.edit=document.getElementById(e);var t=document.getElementById(e).parentNode.getElementsByTagName("DIV");this.dropdownlist=t[0];this.currentitem=null;this.currentitemindex=null;this.visiblecount=0;var n=this;var r=document.getElementById(e).parentNode.getElementsByTagName("SPAN");r[0].onclick=function(){n.edit.focus()};this.edit.onfocus=function(){n.dropdownlist.style.display="block"};this.edit.onblur=function(){if(i)setTimeout(function(){n.dropdownlist.style.display="none"},150)};var i=true;n.dropdownlist.onmousedown=function(e){i=false;return false};n.dropdownlist.onmouseup=function(e){setTimeout(function(){i=true},150);return false};this.listitems=this.dropdownlist.getElementsByTagName("A");for(var s=0;s<this.listitems.length;s++){var o=s;this.listitems[s].onclick=function(){var e=this.innerHTML;e=e.replace(/\<b\>/ig,"");e=e.replace(/\<\/b\>/ig,"");n.edit.value=e;n.dropdownlist.style.display="none";return false};this.listitems[s].onmouseover=function(e){for(var t=0;t<n.listitems.length;t++){if(this==n.listitems[t]){if(n.currentitem){n.currentitem.className=n.currentitem.className.replace(/light/g,"")}n.currentitem=n.listitems[t];n.currentitemindex=t;n.currentitem.className+=" light"}}}}this.edit.onkeydown=function(e){e=e||window.event;if(e.keyCode==38){var t=0;if(n.visiblecount>0){if(n.visiblecount==1){n.currentitemindex=n.listitems.length-1}do{n.currentitemindex--;t++}while(n.currentitemindex>0&&n.listitems[n.currentitemindex].style.display=="none");if(n.currentitemindex<0)n.currentitemindex=n.listitems.length-1;if(n.currentitem){n.currentitem.className=n.currentitem.className.replace(/light/g,"")}n.currentitem=n.listitems[n.currentitemindex];n.currentitem.className+=" light";n.currentitem.scrollIntoView(false)}e.cancelBubble=true;if(navigator.appName!="Microsoft Internet Explorer"){e.preventDefault();e.stopPropagation()}return false}else if(e.keyCode==40){var r=0;if(n.visiblecount>0){do{n.currentitemindex++}while(n.currentitemindex<n.listitems.length&&n.listitems[n.currentitemindex].style.display=="none");if(n.currentitemindex>=n.listitems.length)n.currentitemindex=0;if(n.currentitem){n.currentitem.className=n.currentitem.className.replace(/light/g,"")}n.currentitem=n.listitems[n.currentitemindex];n.currentitem.className+=" light";n.currentitem.scrollIntoView(false)}e.cancelBubble=true;if(navigator.appName!="Microsoft Internet Explorer"){e.preventDefault();e.stopPropagation()}return false}};this.edit.onkeyup=function(e){e=e||window.event;if(e.keyCode==13){if(n.visiblecount!=0){var t=n.currentitem.innerHTML;t=t.replace(/\<b\>/ig,"");t=t.replace(/\<\/b\>/ig,"");n.edit.value=t}n.dropdownlist.style.display="none";e.cancelBubble=true;return false}else{n.dropdownlist.style.display="block";n.visiblecount=0;if(n.edit.value==""){for(var r=0;r<n.listitems.length;r++){n.listitems[r].style.display="block";n.visiblecount++;var i=n.listitems[r].innerHTML;i=i.replace(/\<b\>/ig,"");n.listitems[r].innerHTML=i.replace(/\<\/b\>/ig,"")}}else{var s=new RegExp("("+n.edit.value+")","i");for(var r=0;r<n.listitems.length;r++){var i=n.listitems[r].innerHTML;i=i.replace(/\<b\>/ig,"");i=i.replace(/\<\/b\>/ig,"");if(s.test(i)){n.listitems[r].style.display="block";n.visiblecount++;n.listitems[r].innerHTML=i.replace(s,"<b>$1</b>")}else{n.listitems[r].style.display="none"}}}}}}